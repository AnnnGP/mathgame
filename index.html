<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathGame - Competencia Matem√°tica</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;
        
        // Genera un PIN aleatorio de 6 caracteres
        const generatePin = () => Math.random().toString(36).substring(2, 8).toUpperCase();

        function MathGame() {
          const [mode, setMode] = useState('selectMode');
          const [gamePin, setGamePin] = useState(generatePin());
          const [inputPin, setInputPin] = useState('');
          
          const [teams, setTeams] = useState([]);
          const [numTeams, setNumTeams] = useState(2);
          const [difficulty, setDifficulty] = useState('media');
          const [totalQuestions, setTotalQuestions] = useState(10);

          const [currentQuestion, setCurrentQuestion] = useState(null);
          const [teamAnswers, setTeamAnswers] = useState({}); // Respuestas para el profesor
          const [showResults, setShowResults] = useState(false);
          const [questionNumber, setQuestionNumber] = useState(1);
          const [timeLeft, setTimeLeft] = useState(20);

          // Estado del alumno (solo para simulaci√≥n local)
          const [teamId, setTeamId] = useState(null);
          const [alumnoRespuesta, setAlumnoRespuesta] = useState(null);
          const [respuestaEnviada, setRespuestaEnviada] = useState(false);

          // L√≥gica del temporizador
          useEffect(() => {
            if ((mode === 'profesorPlaying' || mode === 'alumnoPlaying') && !showResults && timeLeft > 0) {
              const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);
              return () => clearTimeout(timer);
            }
            if (timeLeft === 0 && !showResults && mode === 'profesorPlaying') {
              // Profesor muestra resultados al terminar el tiempo
              setShowResults(true);
            }
          }, [timeLeft, mode, showResults]);

          // Generaci√≥n de Preguntas de C√°lculo
          const generateCalculoQuestion = useCallback(() => {
            let a, b, answer;
            const operations = ['+', '-', '√ó', '√∑'];
            const selectedOp = operations[Math.floor(Math.random() * operations.length)];
            let maxVal;

            if (difficulty === 'facil') maxVal = 20;
            else if (difficulty === 'media') maxVal = 50;
            else maxVal = 100;

            a = Math.floor(Math.random() * maxVal) + 1;
            b = Math.floor(Math.random() * maxVal) + 1;

            if (selectedOp === '+') {
              answer = a + b;
            } else if (selectedOp === '-') {
              if (a < b) [a, b] = [b, a]; // Asegura resultado positivo
              answer = a - b;
            } else if (selectedOp === '√ó') {
              if (difficulty === 'facil') b = Math.floor(Math.random() * 10) + 1;
              answer = a * b;
            } else { // '√∑'
              b = b !== 0 ? Math.floor(Math.random() * 10) + 1 : 1;
              answer = Math.floor(a / b);
              a = answer * b; // Ajusta 'a' para que la divisi√≥n sea exacta
            }

            const options = [answer];
            while (options.length < 4) {
              const wrong = answer + (Math.random() > 0.5 ? 1 : -1) * (Math.floor(Math.random() * (maxVal < 20 ? 5 : 10)) + 1);
              if (!options.includes(wrong) && wrong >= 0) options.push(wrong);
            }

            return {
              type: 'calculo',
              question: `${a} ${selectedOp} ${b}`,
              answer: answer,
              options: options.sort(() => Math.random() - 0.5),
              icon: 'üßÆ'
            };
          }, [difficulty]);

          // Generaci√≥n de Preguntas de L√≥gica
          const generateLogicQuestion = useCallback(() => {
            const logicQuestions = [
              {
                question: 'Si 2+2=5, 3+3=7, 4+4=?',
                answer: 9, options: [8, 9, 10, 11], hint: 'La respuesta es el doble +1'
              },
              {
                question: 'Un caracol sube 3m de d√≠a y baja 2m de noche. ¬øCu√°ntos d√≠as tarda en subir 10m?',
                answer: 8, options: [8, 9, 10, 12], hint: 'Piensa en el √∫ltimo d√≠a: al comienzo del d√≠a 8 estar√° en 7m, ese d√≠a sube 3m.'
              },
              {
                question: '¬øCu√°ntas veces cabe el n√∫mero 1 en el n√∫mero 11?',
                answer: 2, options: [1, 2, 3, 11], hint: 'Contando los d√≠gitos: uno y uno.'
              },
              {
                question: 'Si un cuadrado tiene 4 lados, ¬øcu√°ntos lados tiene el √°ngulo de un cuadrado?',
                answer: 0, options: [0, 1, 2, 4], hint: 'Un √°ngulo no es una forma geom√©trica con lados.'
              },
              {
                question: 'Juan tiene 5 manzanas. Da 2 a Mar√≠a. ¬øCu√°ntas le quedan?',
                answer: 3, options: [1, 2, 3, 5], hint: 'Resta simple: 5-2.'
              },
              {
                question: '¬øCu√°l es el siguiente n√∫mero? 2, 4, 8, 16, ?',
                answer: 32, options: [24, 28, 32, 64], hint: 'Se multiplica por 2 (serie geom√©trica).'
              }
            ];
            
            const q = logicQuestions[Math.floor(Math.random() * logicQuestions.length)];
            const options = [...q.options].sort(() => Math.random() - 0.5);
            return {
              type: 'logica',
              question: q.question,
              answer: q.answer,
              options: options,
              hint: q.hint,
              icon: 'üß©'
            };
          }, []);

          // Funci√≥n para generar la pregunta actual (alternando L√≥gica y C√°lculo)
          const generateQuestion = useCallback(() => {
            // Alterna entre c√°lculo (impar) y l√≥gica (par)
            const isCalculo = questionNumber % 2 !== 0; 
            return isCalculo ? generateCalculoQuestion() : generateLogicQuestion();
          }, [questionNumber, generateCalculoQuestion, generateLogicQuestion]);


          // Iniciar Juego (Profesor)
          const initGameProfesor = () => {
            const newTeams = Array(numTeams).fill(0).map((_, i) => ({
              id: i,
              name: `Equipo ${i + 1}`,
              score: 0
            }));
            setTeams(newTeams);
            setTeamAnswers({});
            setQuestionNumber(1);
            setCurrentQuestion(generateQuestion());
            setTimeLeft(20);
            setShowResults(false);
            setMode('profesorPlaying');
          };

          // Alumno se une (Simulaci√≥n local: siempre al Equipo 1)
          const unirAlEquipo = () => {
            if (inputPin.toUpperCase() === gamePin) {
              // En un juego real, esto requerir√≠a un servidor para asignar un ID de equipo real
              setTeamId(0); 
              setMode('alumnoPlaying');
              setRespuestaEnviada(false); // Reiniciar estado
              setAlumnoRespuesta(null);
            } else {
              alert('PIN incorrecto. Aseg√∫rate de que el Profesor haya iniciado la partida.');
              setInputPin('');
            }
          };

          // Alumno selecciona respuesta
          const handleAlumnoAnswer = (option) => {
            if (!respuestaEnviada) {
              setAlumnoRespuesta(option);
            }
          };

          // Alumno env√≠a respuesta
          const enviarRespuesta = () => {
            if (alumnoRespuesta !== null && !respuestaEnviada) {
              // *** SIMULACI√ìN: ENV√çA RESPUESTA DEL ALUMNO AL ESTADO DEL PROFESOR ***
              // En un juego real, esto ser√≠a una llamada al servidor.
              setTeamAnswers(prev => ({
                ...prev,
                [teamId]: alumnoRespuesta // Guardamos la respuesta del alumno local
              }));
              setRespuestaEnviada(true);
            }
          };

          // Siguiente pregunta (Profesor)
          const nextQuestion = () => {
            // 1. Calcular puntos
            const newTeams = teams.map(team => {
              const teamAnswer = teamAnswers[team.id];
              if (teamAnswer === currentQuestion.answer) {
                const points = difficulty === 'facil' ? 10 : difficulty === 'media' ? 20 : 30;
                return { ...team, score: team.score + points };
              }
              return team;
            });
            setTeams(newTeams);

            // 2. Transici√≥n
            if (questionNumber >= totalQuestions) {
              setMode('resultados');
            } else {
              setTeamAnswers({}); // Resetear respuestas
              setQuestionNumber(questionNumber + 1);
              setCurrentQuestion(generateQuestion());
              setTimeLeft(20);
              setShowResults(false);
              setRespuestaEnviada(false); // Resetear estado del alumno local
              setAlumnoRespuesta(null); // Resetear respuesta del alumno local
            }
          };

          // Salir y resetear
          const salir = () => {
            setMode('selectMode');
            setTeams([]);
            setTeamAnswers({});
            setQuestionNumber(1);
            setTeamId(null);
            setAlumnoRespuesta(null);
            setRespuestaEnviada(false);
            setGamePin(generatePin()); // Nuevo PIN para la siguiente sesi√≥n
          };

          // Generar QR (solo para compartir la URL base)
          const generateQRSvg = (pin) => {
            const url = pin ? `${window.location.href}?pin=${pin}` : window.location.href;
            const encodedText = encodeURIComponent(url);
            return `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodedText}`;
          };

          // Descargar QR
          const descargarQR = () => {
            const link = document.createElement('a');
            link.href = generateQRSvg(gamePin);
            link.download = 'MathGame_PIN_QR.png';
            link.click();
          };

          // --- VISTAS ---

          // PANTALLA INICIAL
          if (mode === 'selectMode') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center p-4">
                <div className="bg-white rounded-lg shadow-2xl p-8 max-w-md w-full">
                  <h1 className="text-4xl font-extrabold text-center mb-2 text-gray-800">üß† MathGame</h1>
                  <p className="text-center text-gray-600 mb-8">¬°C√°lculo, l√≥gica y acertijos! Ideal para jugar en clase.</p>

                  <div className="space-y-4 mb-8">
                    <button
                      onClick={() => setMode('profesorMenu')}
                      className="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-4 px-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition flex items-center justify-center gap-2"
                    >
                      üì∫ Soy Profesor
                    </button>
                    <button
                      onClick={() => setMode('alumnoMenu')}
                      className="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-4 px-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transition flex items-center justify-center gap-2"
                    >
                      üì± Soy Alumno
                    </button>
                  </div>

                  <div className="border-t-2 border-gray-200 pt-6">
                    <p className="text-center text-sm text-gray-600 mb-4">üì± QR para compartir el juego</p>
                    <div className="flex flex-col items-center gap-4">
                      <img src={generateQRSvg()} alt="MathGame QR" className="w-32 h-32 border-4 border-blue-400 p-2 bg-white rounded-xl shadow-md" />
                      <button
                        onClick={descargarQR}
                        className="bg-gradient-to-r from-purple-500 to-purple-600 text-white py-2 px-4 rounded-lg font-semibold hover:shadow-lg transition flex items-center justify-center gap-2 text-sm"
                      >
                        ‚¨áÔ∏è Descargar QR
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            );
          }

          // MEN√ö PROFESOR
          if (mode === 'profesorMenu') {
            const points = difficulty === 'facil' ? 10 : difficulty === 'media' ? 20 : 30;
            return (
              <div className="min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center p-4">
                <div className="bg-white rounded-xl shadow-2xl p-8 max-w-md w-full">
                  <h1 className="text-3xl font-bold text-center mb-6 text-gray-800">Configuraci√≥n Profesor</h1>

                  <div className="bg-yellow-50 border-4 border-yellow-400 p-4 rounded-xl mb-6 text-center shadow-inner">
                    <p className="text-sm font-semibold text-gray-700">C√≥digo de sesi√≥n</p>
                    <p className="text-5xl font-extrabold text-yellow-600 tracking-widest">{gamePin}</p>
                    <p className="text-xs text-gray-600 mt-2">Comparte este PIN con tus alumnos</p>
                  </div>

                  <div className="space-y-6">
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">N√∫mero de equipos: <span className="text-blue-600 font-extrabold">{numTeams}</span></label>
                      <input type="range" min="2" max="6" value={numTeams} onChange={(e) => setNumTeams(parseInt(e.target.value))} className="w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer" />
                    </div>

                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">Dificultad (Puntos por acierto: +{points}):</label>
                      <div className="grid grid-cols-3 gap-2">
                        {['facil', 'media', 'dificil'].map(level => (
                          <button key={level} onClick={() => setDifficulty(level)} className={`w-full py-2 px-4 rounded-lg font-semibold transition shadow ${difficulty === level ? 'bg-blue-600 text-white shadow-xl scale-105' : 'bg-gray-200 text-gray-800 hover:bg-gray-300'}`}>
                            {level.charAt(0).toUpperCase() + level.slice(1)}
                          </button>
                        ))}
                      </div>
                    </div>

                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">N√∫mero de preguntas: <span className="text-blue-600 font-extrabold">{totalQuestions}</span></label>
                      <input type="range" min="5" max="30" step="5" value={totalQuestions} onChange={(e) => setTotalQuestions(parseInt(e.target.value))} className="w-full h-2 bg-blue-200 rounded-lg appearance-none cursor-pointer" />
                    </div>

                    <button onClick={initGameProfesor} className="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white py-3 px-4 rounded-xl font-bold text-lg hover:shadow-2xl transition shadow-lg">‚ñ∂Ô∏è Comenzar Juego</button>
                    <button onClick={salir} className="w-full bg-gray-500 text-white py-2 px-4 rounded-xl font-semibold hover:bg-gray-600 transition">Volver</button>
                  </div>
                </div>
              </div>
            );
          }

          // MEN√ö ALUMNO
          if (mode === 'alumnoMenu') {
            return (
              <div className="min-h-screen bg-gradient-to-br from-green-500 to-blue-600 flex items-center justify-center p-4">
                <div className="bg-white rounded-xl shadow-2xl p-8 max-w-md w-full">
                  <h1 className="text-3xl font-bold text-center mb-6 text-gray-800">Unirse a la partida</h1>

                  <div className="space-y-6">
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">C√≥digo PIN de la sesi√≥n:</label>
                      <input 
                        type="text" 
                        value={inputPin} 
                        onChange={(e) => setInputPin(e.target.value.toUpperCase())} 
                        placeholder="Ej: ABC123" 
                        maxLength="6" 
                        className="w-full p-3 border-4 border-green-400 rounded-lg text-center text-4xl font-extrabold tracking-widest text-gray-800 uppercase focus:border-green-600" 
                      />
                    </div>

                    <button onClick={unirAlEquipo} className="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white py-3 px-4 rounded-xl font-bold text-lg hover:shadow-xl transition shadow-lg">üöÄ Unirse</button>
                    <button onClick={() => setMode('selectMode')} className="w-full bg-gray-500 text-white py-2 px-4 rounded-xl font-semibold hover:bg-gray-600 transition">Volver</button>
                  </div>
                </div>
              </div>
            );
          }

          // PROFESOR - JUGANDO
          if (mode === 'profesorPlaying') {
            const timeColor = timeLeft > 10 ? 'text-green-600' : timeLeft > 5 ? 'text-yellow-600' : 'text-red-600';
            const isLogicQuestion = currentQuestion?.type === 'logica';
            const currentPoints = difficulty === 'facil' ? 10 : difficulty === 'media' ? 20 : 30;

            return (
              <div className="min-h-screen bg-gray-100 flex items-center justify-center p-4">
                <div className="bg-white rounded-xl shadow-2xl p-8 max-w-5xl w-full">
                  <h2 className="text-center text-3xl font-extrabold text-indigo-700 mb-6">Pantalla del Profesor (PIN: {gamePin})</h2>
                  
                  <div className="flex justify-between items-center mb-6 border-b-2 pb-4">
                    <div className="text-center p-3 rounded-lg bg-indigo-50"><p className="text-sm font-semibold text-gray-600">Pregunta</p><p className="text-3xl font-bold text-indigo-600">{questionNumber}/{totalQuestions}</p></div>
                    <div className="text-center p-3 rounded-lg bg-indigo-50"><span className="text-3xl">{currentQuestion?.icon}</span><p className="text-sm font-semibold text-gray-600">{isLogicQuestion ? 'üß© L√≥gica' : 'üßÆ C√°lculo'}</p></div>
                    <div className={`text-center p-3 rounded-lg bg-indigo-50 ${timeColor}`}><p className="text-sm font-semibold text-gray-600">Tiempo</p><p className="text-4xl font-extrabold">{timeLeft}s</p></div>
                  </div>

                  {/* √Årea de la Pregunta */}
                  <div className={`rounded-xl p-10 mb-8 text-center shadow-lg border-4 ${isLogicQuestion ? 'bg-gradient-to-r from-purple-100 to-pink-100 border-purple-400' : 'bg-gradient-to-r from-yellow-100 to-yellow-50 border-yellow-400'}`}>
                    <p className={`font-bold ${isLogicQuestion ? 'text-3xl text-purple-800' : 'text-6xl text-gray-800'}`}>{currentQuestion?.question}</p>
                    {isLogicQuestion && <p className="text-lg text-purple-600 italic mt-4">üí° Pista: {currentQuestion?.hint}</p>}
                  </div>

                  {/* Opciones (Deshabilitadas en vista Profesor) */}
                  <div className="grid grid-cols-2 gap-4 mb-8">
                    {currentQuestion?.options.map((option, idx) => (
                      <div key={idx} className={`text-white p-6 rounded-lg font-bold text-3xl text-center opacity-85 shadow-md ${isLogicQuestion ? 'bg-gradient-to-br from-purple-500 to-purple-600' : 'bg-gradient-to-br from-blue-500 to-blue-600'}`}>{option}</div>
                    ))}
                  </div>

                  {/* Monitor de Respuestas */}
                  <div className="mb-6">
                    <p className="text-xl font-bold text-gray-700 mb-3 text-center">Respuestas Recibidas ({Object.keys(teamAnswers).length}/{numTeams})</p>
                    <div className="grid gap-3" style={{ gridTemplateColumns: `repeat(auto-fit, minmax(150px, 1fr))` }}>
                      {teams.map(team => (
                        <div key={team.id} className={`p-4 rounded-xl text-center font-bold transition shadow ${teamAnswers[team.id] !== undefined ? 'bg-green-100 text-green-800 scale-105 border-4 border-green-500' : 'bg-gray-200 text-gray-600'}`}>
                          <p className="text-sm mb-1">{team.name}</p>
                          <p className="text-2xl">{teamAnswers[team.id] !== undefined ? '¬°Recibida!' : 'Esperando...'}</p>
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* Resultados y Bot√≥n Siguiente */}
                  {showResults && (
                    <div className="mt-8 p-6 bg-yellow-50 rounded-xl border-4 border-yellow-400 shadow-xl">
                      <p className="text-center font-extrabold text-2xl mb-4 text-green-700">‚úì RESPUESTA CORRECTA: <span className="text-4xl text-green-900">{currentQuestion?.answer}</span></p>
                      
                      <div className="grid gap-3 mb-6" style={{ gridTemplateColumns: `repeat(auto-fit, minmax(120px, 1fr))` }}>
                        {teams.map(team => {
                          const isCorrect = teamAnswers[team.id] === currentQuestion?.answer;
                          return (
                            <div key={team.id} className={`p-3 rounded-lg text-center font-bold shadow ${isCorrect ? 'bg-green-200 text-green-800 border-2 border-green-500' : 'bg-red-200 text-red-800 border-2 border-red-500'}`}>
                              <p className="text-sm">{team.name}</p>
                              <p className="text-lg">{isCorrect ? `‚úì +${currentPoints} pts` : '‚úó 0 pts'}</p>
                            </div>
                          );
                        })}
                      </div>

                      <div className="mb-6 p-4 bg-white rounded-lg border-2 border-gray-300 shadow-inner">
                        <p className="text-center font-bold text-gray-700 mb-3 text-xl">üèÜ Clasificaci√≥n Actual</p>
                        <div className="space-y-2">
                          {[...teams].sort((a, b) => b.score - a.score).map((team, idx) => (
                            <div key={team.id} className="flex items-center justify-between px-3 py-2 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg">
                              <span className="font-extrabold text-lg">{idx + 1}. {team.name}</span>
                              <span className="text-xl font-extrabold text-blue-600">{team.score} pts</span>
                            </div>
                          ))}
                        </div>
                      </div>

                      <button onClick={nextQuestion} className="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white py-3 px-4 rounded-xl font-bold text-lg hover:shadow-2xl transition shadow-lg">Siguiente Pregunta ‚Üí</button>
                    </div>
                  )}

                  <button onClick={salir} className="mt-6 w-full bg-red-500 text-white py-2 px-4 rounded-xl font-semibold hover:bg-red-600 transition shadow">üî¥ Salir y Terminar Sesi√≥n</button>
                </div>
              </div>
            );
          }

          // ALUMNO - JUGANDO
          if (mode === 'alumnoPlaying') {
            const isLogicQuestion = currentQuestion?.type === 'logica';

            // El alumno solo ve la pregunta actual, si el profesor ya mostr√≥ resultados, no se puede responder
            if (showResults) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-red-500 to-orange-600 flex items-center justify-center p-4">
                        <div className="bg-white rounded-xl shadow-2xl p-8 max-w-2xl w-full text-center">
                            <p className="text-5xl mb-4">‚è≥</p>
                            <h2 className="text-3xl font-bold text-red-800 mb-4">¬°Tiempo agotado!</h2>
                            <p className="text-xl text-gray-600">Esperando que el profesor muestre la siguiente pregunta...</p>
                        </div>
                    </div>
                );
            }

            return (
              <div className="min-h-screen bg-gradient-to-br from-green-500 to-teal-600 flex items-center justify-center p-4">
                <div className="bg-white rounded-xl shadow-2xl p-8 max-w-2xl w-full">
                  <div className="flex justify-between items-center mb-6 border-b-2 pb-4">
                    <div className="text-center flex-1"><p className="text-sm font-semibold text-gray-600">Pregunta</p><p className="text-3xl font-bold text-green-600">{questionNumber}/{totalQuestions}</p></div>
                    <div className="text-center flex-1"><span className="text-3xl">{currentQuestion?.icon}</span><p className="text-sm font-semibold text-gray-600">{isLogicQuestion ? 'üß© L√≥gica' : 'üßÆ C√°lculo'}</p></div>
                    <div className="text-center flex-1"><p className="text-sm font-semibold text-gray-600">Tiempo</p><p className="text-4xl font-extrabold text-red-600">{timeLeft}s</p></div>
                  </div>
                  
                  {/* Pregunta */}
                  <div className={`rounded-xl p-8 mb-8 text-center shadow-md border-4 ${isLogicQuestion ? 'bg-gradient-to-r from-purple-100 to-pink-100 border-purple-400' : 'bg-gradient-to-r from-yellow-100 to-yellow-50 border-yellow-400'}`}>
                    <p className={`font-extrabold ${isLogicQuestion ? 'text-3xl text-purple-800' : 'text-5xl text-gray-800'}`}>{currentQuestion?.question}</p>
                    {isLogicQuestion && <p className="text-md text-purple-600 italic mt-3">üí° ¬°A pensar!</p>}
                  </div>

                  {/* Opciones */}
                  <div className="grid grid-cols-2 gap-4 mb-6">
                    {currentQuestion?.options.map((option, idx) => (
                      <button 
                        key={idx} 
                        onClick={() => handleAlumnoAnswer(option)} 
                        disabled={respuestaEnviada || timeLeft === 0}
                        className={`text-white p-6 rounded-xl font-bold text-3xl transition transform shadow-lg 
                          ${alumnoRespuesta === option && !respuestaEnviada ? 'ring-4 ring-yellow-400 scale-105' : ''} 
                          ${respuestaEnviada ? 'opacity-50 cursor-not-allowed' : 'hover:scale-[1.02]'}
                          ${isLogicQuestion ? 'bg-gradient-to-br from-purple-500 to-purple-600 hover:from-purple-600' : 'bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600'}`
                        }
                      >
                        {option}
                      </button>
                    ))}
                  </div>

                  {/* Bot√≥n Enviar */}
                  {alumnoRespuesta !== null && !respuestaEnviada ? (
                    <button onClick={enviarRespuesta} className="w-full bg-gradient-to-r from-green-500 to-teal-600 text-white py-4 px-4 rounded-xl font-bold text-lg hover:shadow-2xl transition shadow-lg">‚úì ¬°Listo! Enviar Respuesta</button>
                  ) : respuestaEnviada ? (
                    <div className="w-full bg-yellow-500 text-white py-4 px-4 rounded-xl font-bold text-lg text-center shadow-inner">‚úÖ ¬°Respuesta Enviada! Esperando al Profesor...</div>
                  ) : (
                    <div className="w-full bg-gray-300 text-gray-700 py-4 px-4 rounded-xl font-bold text-lg text-center shadow-inner">Selecciona una respuesta para enviar</div>
                  )}
                </div>
              </div>
            );
          }

          // RESULTADOS FINALES
          if (mode === 'resultados') {
            const sortedTeams = [...teams].sort((a, b) => b.score - a.score);

            return (
              <div className="min-h-screen bg-gradient-to-br from-yellow-400 to-orange-500 flex items-center justify-center p-4">
                <div className="bg-white rounded-xl shadow-2xl p-8 max-w-2xl w-full">
                  <div className="text-center mb-8">
                    <h1 className="text-5xl font-extrabold text-orange-800 mb-2">üéâ ¬°RESULTADOS FINALES!</h1>
                    <p className="text-xl text-gray-600">¬°Gracias por jugar!</p>
                  </div>

                  <div className="space-y-4 mb-8">
                    {sortedTeams.map((team, idx) => (
                      <div key={team.id} className={`p-5 rounded-xl flex items-center justify-between font-extrabold text-xl shadow-lg ${idx === 0 ? 'bg-yellow-200 border-4 border-yellow-600 text-yellow-900 scale-105' : idx === 1 ? 'bg-gray-200 border-4 border-gray-500 text-gray-800' : idx === 2 ? 'bg-orange-200 border-4 border-orange-500 text-orange-800' : 'bg-white border-2 border-gray-300 text-gray-700'}`}>
                        <span>{idx === 0 ? 'ü•á' : idx === 1 ? 'ü•à' : idx === 2 ? 'ü•â' : `${idx + 1}¬∫`} - {team.name}</span>
                        <span className="text-3xl">{team.score} PTS</span>
                      </div>
                    ))}
                  </div>

                  <button onClick={salir} className="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 px-4 rounded-xl font-bold text-lg hover:shadow-xl transition shadow-lg">Volver al inicio</button>
                </div>
              </div>
            );
          }
        }

        // Renderizar la aplicaci√≥n React
        ReactDOM.createRoot(document.getElementById('root')).render(<MathGame />);
    </script>
</body>
</html>
