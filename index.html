```html
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MathGame</title>
  https://unpkg.com/react@18/umd/react.production.min.js</script>
  https://unpkg.com/react-dom@18/umd/react-dom.production.min.js</script>
  https://cdn.tailwindcss.com</script>
  <style>
    body { margin: 0; font-family: 'Inter', sans-serif; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script>
    const { useState, useEffect } = React;

    function MathGame() {
      const [mode, setMode] = useState('selectMode');
      const [gamePin, setGamePin] = useState(Math.random().toString(36).substring(2, 8).toUpperCase());
      const [inputPin, setInputPin] = useState('');
      const [joinError, setJoinError] = useState(false);
      const [teams, setTeams] = useState([]);
      const [numTeams, setNumTeams] = useState(2);
      const [difficulty, setDifficulty] = useState('media');
      const [currentQuestion, setCurrentQuestion] = useState(null);
      const [teamAnswers, setTeamAnswers] = useState({});
      const [showResults, setShowResults] = useState(false);
      const [questionNumber, setQuestionNumber] = useState(1);
      const [timeLeft, setTimeLeft] = useState(20);
      const [totalQuestions, setTotalQuestions] = useState(10);
      const [teamId, setTeamId] = useState(null);
      const [alumnoRespuesta, setAlumnoRespuesta] = useState(null);

      useEffect(() => {
        if ((mode === 'profesorPlaying' || mode === 'alumnoPlaying') && !showResults && timeLeft > 0) {
          const timer = setTimeout(() => setTimeLeft(timeLeft - 1), 1000);
          return () => clearTimeout(timer);
        }
        if (timeLeft === 0 && !showResults && (mode === 'profesorPlaying' || mode === 'alumnoPlaying')) {
          setShowResults(true);
        }
      }, [timeLeft, mode, showResults]);

      const generateCalculoQuestion = () => {
        let a, b, answer;
        const ops = ['+', '-', '×', '÷'];
        const op = ops[Math.floor(Math.random() * ops.length)];
        let maxVal = difficulty === 'facil' ? 20 : difficulty === 'media' ? 50 : 100;
        a = Math.floor(Math.random() * maxVal) + 1;
        b = Math.floor(Math.random() * maxVal) + 1;
        if (op === '+') answer = a + b;
        else if (op === '-') { if (a < b) [a, b] = [b, a]; answer = a - b; }
        else if (op === '×') { if (difficulty !== 'dificil') { a = Math.floor(Math.random() * 10) + 1; b = Math.floor(Math.random() * 10) + 1; } answer = a * b; }
        else { b = b || 1; answer = Math.floor(a / b); a = answer * b; }
        const options = [answer];
        while (options.length < 4) {
          let wrong = answer + (Math.random() > 0.5 ? 1 : -1) * (Math.floor(Math.random() * 5) + 1);
          if (!options.includes(wrong) && wrong >= 0) options.push(wrong);
        }
        return { type: 'calculo', question: `${a} ${op} ${b}`, answer, options: options.sort(() => Math.random() - 0.5) };
      };

      const generateLogicQuestion = () => {
        const qs = [
          { question: 'Si 2+2=5, 3+3=7, 4+4=?', answer: 9, options: [8, 9, 10, 11], hint: 'Se suma 1 extra.' },
          { question: 'Un caracol sube 3m y baja 2m. ¿Cuántos días para 10m?', answer: 8, options: [8, 9, 10, 12], hint: 'Últimos 3m sin bajar.' },
          { question: 'Si tienes 5 peces y 3 se ahogan, ¿cuántos quedan?', answer: 5, options: [2, 3, 5, 8], hint: 'Los peces no se ahogan.' },
          { question: '¿Qué número sigue: 1,1,2,3,5,8,?', answer: 13, options: [11,12,13,15], hint: 'Secuencia Fibonacci.' }
        ];
        const q = qs[Math.floor(Math.random() * qs.length)];
        return { type: 'logica', ...q, options: q.options.sort(() => Math.random() - 0.5) };
      };

      const generateQuestion = () => questionNumber % 2 === 1 ? generateCalculoQuestion() : generateLogicQuestion();

      const initGameProfesor = () => {
        const newTeams = Array(numTeams).fill(0).map((_, i) => ({ id: i, name: `Equipo ${i + 1}`, score: 0 }));
        setTeams(newTeams);
        setTeamAnswers({});
        setQuestionNumber(1);
        setCurrentQuestion(generateQuestion());
        setTimeLeft(20);
        setShowResults(false);
        setMode('profesorPlaying');
      };

      const unirAlEquipo = () => {
        setJoinError(false);
        if (inputPin.toUpperCase() === gamePin) { setTeamId(0); setMode('alumnoPlaying'); }
        else { setJoinError(true); setInputPin(''); }
      };

      const enviarRespuesta = () => {
        if (alumnoRespuesta !== null && teamId !== null) {
          setTeamAnswers(prev => ({ ...prev, [teamId]: alumnoRespuesta }));
          setAlumnoRespuesta(null);
        }
      };

      const nextQuestion = () => {
        if (questionNumber >= totalQuestions) { setMode('resultados'); }
        else {
          const newTeams = teams.map(team => {
            const ans = teamAnswers[team.id];
            if (ans === currentQuestion?.answer) {
              const pts = difficulty === 'facil' ? 10 : difficulty === 'media' ? 20 : 30;
              return { ...team, score: team.score + pts };
            }
            return team;
          });
          setTeams(newTeams);
          setTeamAnswers({});
          setQuestionNumber(questionNumber + 1);
          setCurrentQuestion(generateQuestion());
          setTimeLeft(20);
          setShowResults(false);
        }
      };

      const salir = () => {
        setMode('selectMode');
        setTeams([]);
        setTeamAnswers({});
        setQuestionNumber(1);
        setTeamId(null);
        setAlumnoRespuesta(null);
        setGamePin(Math.random().toString(36).substring(2, 8).toUpperCase());
      };

      if (mode === 'selectMode') {
        return React.createElement('div', { className: 'min-h-screen flex items-center justify-center bg-gray-100' },
          React.createElement('div', { className: 'bg-white p-8 rounded shadow-lg text-center' },
            React.createElement('h1', { className: 'text-4xl font-bold mb-6' }, 'MathGame'),
            React.createElement('button', { onClick: () => setMode('profesorMenu'), className: 'w-full bg-blue-500 text-white py-3 rounded mb-4 font-bold' }, 'Profesorado'),
            React.createElement('button', { onClick: () => setMode('alumnoMenu'), className: 'w-full bg-green-500 text-white py-3 rounded font-bold' }, 'Alumnado')
          )
        );
      }

      if (mode === 'profesorMenu') {
        return React.createElement('div', { className: 'min-h-screen flex items-center justify-center bg-gray-100' },
          React.createElement('div', { className: 'bg-white p-8 rounded shadow-lg w-full max-w-md' },
            React.createElement('h2', { className: 'text-2xl font-bold mb-4' }, 'Configuración'),
            React.createElement('p', { className: 'mb-4 text-center font-bold text-xl' }, `PIN: ${gamePin}`),
            React.createElement('label', null, `Número de equipos: ${numTeams}`),
            React.createElement('input', { type: 'range', min: 2, max: 6, value: numTeams, onChange: e => setNumTeams(parseInt(e.target.value)), className: 'w-full mb-4' }),
            React.createElement('div', { className: 'mb-4 flex gap-2' },
              ['facil', 'media', 'dificil'].map(level =>
                React.createElement('button', { key: level, onClick: () => set
